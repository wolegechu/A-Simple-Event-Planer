function setValidityMsg(e,t,a){e.innerHTML=a;var i=e.parentNode;0===t?i.classList=["form-group has-warning"]:1===t&&(i.classList=["form-group has-success"])}var userName="";firebase.auth().onAuthStateChanged(function(e){e?userName=e.displayName:self.location.href="index.html"});var database=firebase.database(),ref=database.ref("events/"+userName),tableRef=document.querySelector("#tableEvents"),inputLocation=document.querySelector("#inputLocation"),inputComment=document.querySelector("#inputComment"),eventName=document.querySelector("#inputEventName"),startTime=document.querySelector("#inputStartTime"),endTime=document.querySelector("#inputEndTime"),host=document.querySelector("#inputHost"),guestList=document.querySelector("#inputGuestList"),type=document.querySelector("#inputType"),labelEventName=document.querySelector("#labelEventName"),labelStartTime=document.querySelector("#labelStartTime"),labelEndTime=document.querySelector("#labelEndTime"),labelHost=document.querySelector("#labelHost"),labelLocation=document.querySelector("#labelLocation"),labelType=document.querySelector("#labelType"),labelGuestList=document.querySelector("#labelGuestList");ref.orderByKey().once("value").then(function(e){var t=e.val();for(var a in t[userName]){var i=t[userName][a],n=tableRef.insertRow(0);n.innerHTML="<th>"+i.name+"</th><th>"+i.type+"</th><th>"+i.host+"</th><th>"+i.guestList+"</th><th>"+i.startTime+"</th><th>"+i.endTime+"</th><th>"+i.location+"</th><th>"+i.comment+"</th>"}}),ref.on("child_changed",function(e,t){var a=Object.keys(e.val()),i=e.val()[a[a.length-1]],n=tableRef.insertRow(0);n.innerHTML="<th>"+i.name+"</th><th>"+i.type+"</th><th>"+i.host+"</th><th>"+i.guestList+"</th><th>"+i.startTime+"</th><th>"+i.endTime+"</th><th>"+i.location+"</th><th>"+i.comment+"</th>"});var startTimestamp,endTimestamp,currentTimestamp=new Date,startValidity=!1,endValidity=!1;!function(){eventName.addEventListener("input",function(){eventName.value.length>1?setValidityMsg(labelEventName,1,"Event Name"):setValidityMsg(labelEventName,0,"Event Name (required)")}),type.addEventListener("input",function(){type.value.length>1?setValidityMsg(labelType,1,"Event Type"):setValidityMsg(labelType,0,"Event Type (required)")}),inputLocation.addEventListener("input",function(){inputLocation.value.length>1?setValidityMsg(labelLocation,1,"Location"):setValidityMsg(labelLocation,0,"Location (required)")}),host.addEventListener("input",function(){host.value.length>1?setValidityMsg(labelHost,1,"Host"):setValidityMsg(labelHost,0,"Host (required)")}),startTime.addEventListener("keyup",function(){startTimestamp=new Date(startTime.value),startTimestamp>currentTimestamp?(setValidityMsg(labelStartTime,1,"Start Time"),startValidity=!0):(setValidityMsg(labelStartTime,0,"Start Time (it should start in the future)"),startValidity=!1)}),endTime.addEventListener("keyup",function(){endTimestamp=new Date(endTime.value),endTimestamp>startTimestamp?(setValidityMsg(labelEndTime,1,"End Time"),endValidity=!0):(setValidityMsg(labelEndTime,0,"End Time (End date-time should take place after Start date-time)"),endValidity=!1)})}(),document.querySelector("#submit").onclick=function(){if(eventName.value.length>1?setValidityMsg(labelEventName,1,"Event Name"):setValidityMsg(labelEventName,0,"Event Name (required)"),inputLocation.value.length>1?setValidityMsg(labelLocation,1,"Location"):setValidityMsg(labelLocation,0,"Location (required)"),host.value.length>1?setValidityMsg(labelHost,1,"Host"):setValidityMsg(labelHost,0,"Host (required)"),type.value.length>1?setValidityMsg(labelType,1,"Event Type"):setValidityMsg(labelType,0,"Event Type (required)"),guestList.value.length>1?setValidityMsg(labelGuestList,1,"Guest List"):setValidityMsg(labelGuestList,0,"Guest List (required)"),startTimestamp=new Date(startTime.value),startTimestamp>currentTimestamp?setValidityMsg(labelStartTime,1,"Start Time"):setValidityMsg(labelStartTime,0,"Start Time (it should start in the future)"),endTimestamp=new Date(endTime.value),endTimestamp>startTimestamp?setValidityMsg(labelEndTime,1,"End Time"):setValidityMsg(labelEndTime,0,"End Time (End date-time should take place after Start date-time)"),eventName.checkValidity()&&type.checkValidity()&&host.checkValidity()&&startValidity&&endValidity&&guestList.checkValidity()&&inputLocation.checkValidity()){var e={name:eventName.value,type:type.value,host:host.value,startTime:startTime.value,endTime:endTime.value,guestList:guestList.value,location:inputLocation.value,comment:inputComment.value},t=database.ref("events/"+userName).push();t.set(e);var a=document.querySelector('section[data-route="message"]');a.innerHTML='<div class="alert alert-success" role="alert">Created!</div>'}};